==========
Thu Oct 16 12:40:08 -0700 2014

Tentative FragmentFlowService spec:

 1- Requires access to 

     * FragmentNodeProcess, 
     * FragmentNodeFragment,
     * ProcessSubstitution, 
     * FragmentSubstitution

 2- new FragmentFlowService takes an argument, scenario_id (default 0)

 3- new properties, to be populated in the constructor: 
    FragmentFlowService.ProcessID
    FragmentFlowService.SubFragmentID
    FragmentFlowService.TermFlowID

    For NodeTypeID == 1 (Process):

    * TermFlowID = FragmentFlow.FragmentNodeProcess.FlowID

    * if the following is non empty:
        ProcessSubstitution.FragmentNodeProcess
        WHERE ProcessSubstitution.ScenarioID == scenario_id
	AND FragmentNodeProcess.FragmentFlowID == my FragmentFlowID
      then ProcessID = ProcessSubstitution.ProcessID
      else ProcessID = FragmentNodeProcess.ProcessID

    * SubFragmentID = null

    For NodeTypeID == 2 (Fragment):

    * TermFlowID = FragmentFlow.FragmentNodeFragment.FlowID

    * if the following is non empty:
        FragmentSubstitution.FragmentNodeFragment
        WHERE FragmentSubstitution.ScenarioID == scenario_id
	AND FragmentNodeFragment.FragmentFlowID == my FragmentFlowID
      then SubFragmentID = FragmentSubstitution.SubFragmentID
      else SubFragmentID = FragmentNodeFragment.SubFragmentID

    * ProcessID = null

    For NodeTypeID == 3 (I/O) or 4 (Background)
 
    * TermFlowID = FragmentFlow.FlowID

    * ProcessID = null

    * SubFragmentID = null


